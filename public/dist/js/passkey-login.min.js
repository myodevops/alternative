document.addEventListener("DOMContentLoaded",(()=>{const e=document.getElementById("passkey-login-button");e&&e.addEventListener("click",(async e=>{e.preventDefault();try{if(Webpass.isUnsupported())return void alert("Your browser doesn't support WebAuthn.");const e=document.querySelector('meta[name="csrf-token"]')?.getAttribute("content")??"",{user:t,success:n,error:o}=await Webpass.assert("/webauthn/login/options","/webauthn/login",{csrf:e});n?window.location.href="/dashboard":"InvalidStateError"===o?.name||"NotAllowedError"===o?.name?Swal.fire({title:"No Passkey found",text:"It looks like you haven't registered your Passkey yet. Would you like to register now?",icon:"warning",showCancelButton:!0,confirmButtonText:"Register Passkey",cancelButtonText:"Cancel"}).then((e=>{e.isConfirmed&&(window.location.href="/register-passkey")})):Swal.fire({title:"Login Failed",text:o?.message||"An unexpected error occurred during Passkey login.",icon:"error",confirmButtonText:"Ok"})}catch(e){}}))}));